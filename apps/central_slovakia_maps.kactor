script central_slovakia_maps

action main:

/**
 *  Currently creates n .xlsx files containing tables 
 *  for each polygon in the spatial context resource (n = n_tables x n_polygons).
 *  Filenames specify the country.  
 */
	set observables_urns (
		{landcover:LandCoverType}
		{es.nca:BiogeographicRegionType}
		peopleea.bioregions.type_of_forest
//		peopleea.forest.biomass.above_ground_biomass
//		peopleea.forest.biomass.max_above_ground_biomass
//		peopleea.forest.biomass.min_above_ground_biomass
//		peopleea.forest.biomass.indicator_value_of_above_ground_biomass
//		peopleea.forest.lai.indicator_value_of_leaf_area_index
//		peopleea.forest.ndwi.indicator_value_of_normalized_difference_water_index
//		peopleea.condition.forest.indicator_forest_condition
//		{im:Indicator value of ecology:AboveGroundBiomass}
//		{im:Indicator value of ecology:NormalizedDifferenceVegetationIndex}
	)
 	set table_urns (
		peopleea.forest.birds.birds_raw_variable
		peopleea.forest.birds.birds_indicator
//		peopleea.forest.connectivity.forest_connectivity_raw_variable
//		peopleea.forest.connectivity.forest_connectivity_indicator
//		peopleea.forest.ndvi.ndvi_raw_variable
//		peopleea.forest.ndvi.ndvi_ndvi_indicator
	)
	wkt_context = Space(shape='POLYGON ((19.016595 48.192287, 19.008915 48.193323, 19.00882 48.18971, 18.967294 48.180711, 18.959034 48.182458, 18.94827 48.173214, 18.938199 48.17702, 18.928686 48.166169, 18.93166 48.15875, 18.887396 48.162087, 18.88637 48.158948, 18.878506 48.161353, 18.878607 48.156522, 18.870737 48.161411, 18.868443 48.165136, 18.871514 48.166978, 18.855338 48.167266, 18.847965 48.17413, 18.832451 48.177752, 18.824306 48.175752, 18.821207 48.166276, 18.808852 48.164829, 18.798402 48.187383, 18.807442 48.196071, 18.817813 48.195375, 18.820268 48.202599, 18.831701 48.206299, 18.808755 48.229912, 18.820921 48.235564, 18.805666 48.245284, 18.817209 48.260547, 18.840583 48.26807, 18.844106 48.275291, 18.839823 48.285606, 18.852422 48.305788, 18.845394 48.320609, 18.832999 48.321143, 18.824955 48.33126, 18.82427 48.346032, 18.819796 48.346676, 18.816541 48.36306, 18.810571 48.370533, 18.783784 48.376882, 18.776188 48.390157, 18.758998 48.400779, 18.757185 48.408815, 18.74595 48.416456, 18.731439 48.416777, 18.714376 48.399946, 18.698313 48.393109, 18.702678 48.389739, 18.688336 48.381728, 18.689118 48.374628, 18.679042 48.373737, 18.681074 48.362199, 18.675544 48.355072, 18.652793 48.345181, 18.652486 48.351019, 18.634946 48.353886, 18.612639 48.343784, 18.580501 48.344665, 18.573507 48.348258, 18.564679 48.33918, 18.558512 48.339443, 18.5580156 48.3285213, 18.544707 48.322499, 18.537443 48.309813, 18.534633 48.311869, 18.533625 48.322355, 18.541729 48.327054, 18.524412 48.332642, 18.530982 48.335836, 18.536377 48.331799, 18.540943 48.336159, 18.536835 48.341319, 18.548205 48.344756, 18.544932 48.350159, 18.566959 48.358694, 18.569846 48.363446, 18.567087 48.370612, 18.576243 48.375922, 18.568675 48.393434, 18.570748 48.404045, 18.56626 48.40529, 18.56065 48.418203, 18.538781 48.417782, 18.545805 48.436041, 18.535108 48.439482, 18.532638 48.452011, 18.520971 48.451041, 18.531148 48.466488, 18.546591 48.476962, 18.531065 48.474118, 18.537815 48.503503, 18.532086 48.507962, 18.529139 48.50533, 18.5105 48.509612, 18.496064 48.506877, 18.495674 48.499724, 18.4811 48.499796, 18.500034 48.520977, 18.518049 48.528946, 18.502519 48.526003, 18.488809 48.543823, 18.478673 48.548602, 18.487335 48.549302, 18.497467 48.568849, 18.506122 48.562274, 18.516296 48.565612, 18.530773 48.561325, 18.534441 48.564758, 18.56727 48.566977, 18.565188 48.570069, 18.577452 48.577469, 18.597696 48.575273, 18.601623 48.592587, 18.621284 48.607485, 18.643154 48.633123, 18.656502 48.63992, 18.717252 48.626793, 18.71985 48.633256, 18.714173 48.648277, 18.741352 48.662036, 18.74692 48.668703, 18.750117 48.686867, 18.762776 48.69718, 18.780564 48.693826, 18.796142 48.700615, 18.826438 48.736373, 18.826685 48.744938, 18.823078 48.755705, 18.814448 48.758779, 18.810144 48.769167, 18.776719 48.790778, 18.780316 48.804177, 18.769483 48.808584, 18.777958 48.812747, 18.754071 48.817567, 18.750522 48.820173, 18.752429 48.82689, 18.729141 48.832006, 18.698074 48.847707, 18.700684 48.869085, 18.695423 48.880702, 18.704106 48.887086, 18.707939 48.897488, 18.693642 48.908901, 18.697564 48.917674, 18.693749 48.925612, 18.702999 48.926381, 18.703606 48.93064, 18.710664 48.929167, 18.713803 48.935957, 18.720277 48.937493, 18.712707 48.94772, 18.694557 48.959175, 18.665351 48.956108, 18.631726 48.965034, 18.603185 48.963773, 18.601141 48.956418, 18.595104 48.956796, 18.584113 48.971452, 18.577951 48.971306, 18.561585 48.957561, 18.559806 48.949335, 18.538535 48.946755, 18.523407 48.937052, 18.479578 48.939562, 18.46594 48.948036, 18.463733 48.955632, 18.497191 48.963535, 18.506223 48.971033, 18.510873 48.983206, 18.530783 48.992304, 18.569639 48.998098, 18.587131 49.014231, 18.586367 49.018612, 18.599602 49.024233, 18.602614 49.041074, 18.59514 49.048118, 18.602795 49.054127, 18.598923 49.072743, 18.579029 49.0862, 18.557 49.087588, 18.559581 49.093649, 18.583413 49.106483, 18.590958 49.116488, 18.574688 49.124301, 18.577849 49.134381, 18.574914 49.143188, 18.553361 49.146777, 18.555127 49.154833, 18.533767 49.164206, 18.517352 49.166322, 18.508106 49.175849, 18.467647 49.189501, 18.462819 49.198013, 18.464305 49.204572, 18.446647 49.212336, 18.450792 49.218215, 18.441751 49.225048, 18.439355 49.236272, 18.427142 49.248019, 18.430339 49.254993, 18.398324 49.282561, 18.391739 49.296319, 18.377103 49.303376, 18.373402 49.318983, 18.322605 49.315109, 18.378918 49.330546, 18.394509 49.348277, 18.404255 49.350229, 18.398178 49.356797, 18.415567 49.367549, 18.4036607 49.3966913, 18.411946 49.39908, 18.433228 49.392801, 18.449956 49.393502, 18.456349 49.402974, 18.475691 49.408546, 18.481947 49.423907, 18.494108 49.428183, 18.489964 49.433178, 18.500923 49.435816, 18.5053 49.4429, 18.5229523 49.449235, 18.524801 49.456481, 18.532729 49.458122, 18.536255 49.464421, 18.547951 49.467862, 18.534368 49.484546, 18.534666 49.490188, 18.541633 49.492706, 18.545748 49.50051, 18.572363 49.508286, 18.5972528 49.510237, 18.601907 49.506852, 18.602816 49.497085, 18.617747 49.495062, 18.631542 49.498727, 18.639521 49.496229, 18.642328 49.500789, 18.677825 49.507628, 18.687923 49.500736, 18.711953 49.502252, 18.734908 49.490389, 18.7544821 49.4883823, 18.7791719 49.5049971, 18.812371 49.516377, 18.840213 49.514919, 18.86677 49.519423, 18.897157 49.514421, 18.941662 49.5189, 18.972772 49.502608, 18.973333 49.496807, 18.960451 49.48275, 18.970198 49.476808, 18.964587 49.472438, 18.960783 49.454705, 18.973874 49.451654, 18.977787 49.440532, 18.988972 49.431299, 18.985723 49.4218487, 18.968751 49.4133304, 18.97315 49.406938, 18.971181 49.402063, 18.9798538 49.3952215, 18.9896423 49.3983803, 19.0350225 49.3957194, 19.044693 49.4004467, 19.0539125 49.4151627, 19.0701891 49.4123937, 19.072731 49.417984, 19.091472 49.415973, 19.093639 49.410796, 19.102998 49.409791, 19.107287 49.403682, 19.120358 49.402659, 19.137516 49.409956, 19.150658 49.403645, 19.1756 49.413744, 19.187451 49.409665, 19.197397 49.414564, 19.1857359 49.4347198, 19.198581 49.448161, 19.208989 49.451828, 19.219007 49.448612, 19.225311 49.454314, 19.228263 49.463736, 19.219982 49.469307, 19.220465 49.473491, 19.2315404 49.4868292, 19.2278291 49.4919351, 19.2355148 49.4956578, 19.2332716 49.5104924, 19.2610254 49.5272866, 19.2606883 49.5312291, 19.3103556 49.5370152, 19.3187944 49.5310826, 19.3622997 49.5360882, 19.3685743 49.5450334, 19.3665935 49.5537032, 19.3734541 49.5578504, 19.3713627 49.5674421, 19.4000179 49.5741342, 19.4076416 49.5808269, 19.4099851 49.5921592, 19.442018 49.598501, 19.4462324 49.6133009, 19.4673762 49.6137628, 19.4746169 49.6046527, 19.4684976 49.5964127, 19.478408 49.5880283, 19.5102073 49.5814392, 19.5220086 49.5722347, 19.529331 49.5730216, 19.530449 49.5357702, 19.5516137 49.5076205, 19.5536443 49.4899404, 19.5656288 49.480522, 19.5669128 49.47114, 19.5805818 49.461219, 19.5814677 49.4554092, 19.5974358 49.4586318, 19.611446 49.446873, 19.6411189 49.4575599, 19.6377964 49.4405483, 19.648596 49.435365, 19.631728 49.408797, 19.639481 49.411262, 19.685373 49.403584, 19.716499 49.390963, 19.717643 49.386422, 19.729639 49.391737, 19.7462787 49.4079369, 19.76758 49.412993, 19.7905922 49.4106881, 19.7911317 49.3835114, 19.8038175 49.3648155, 19.802451 49.353136, 19.79472 49.344528, 19.804964 49.322768, 19.792474 49.29974, 19.7945013 49.2960447, 19.8098793 49.2953969, 19.822802 49.276794, 19.792472 49.267969, 19.7846935 49.2462266, 19.7667676 49.2365983, 19.7669425 49.2226128, 19.758386 49.2159804, 19.7631071 49.2075775, 19.778588 49.204955, 19.784254 49.199287, 19.795032 49.198366, 19.807521 49.205652, 19.819834 49.199528, 19.8294593 49.2016922, 19.841 49.192616, 19.869438 49.195797, 19.881104 49.204367, 19.900351 49.200219, 19.897108 49.186395, 19.902221 49.18166, 19.915253 49.181891, 19.923186 49.157141, 19.894896 49.131288, 19.913312 49.121212, 19.914748 49.129028, 19.926903 49.14194, 19.957998 49.143893, 19.979014 49.156539, 20.000131 49.162818, 19.985921 49.152747, 19.980937 49.140516, 19.963982 49.138998, 19.948699 49.127483, 19.947518 49.119468, 19.952719 49.109272, 19.970884 49.117826, 19.97509 49.10852, 19.992872 49.108323, 19.988902 49.105359, 20.004597 49.10366, 20.027094 49.110985, 20.037754 49.108312, 20.028832 49.087456, 20.030163 49.077828, 20.026715 49.072107, 20.019377 49.070879, 20.027025 49.055583, 20.012858 49.036045, 20.015293 49.015977, 19.981902 49.012256, 19.968958 49.01657, 19.963551 49.008929, 19.988665 48.996503, 20.010461 48.97218, 20.023183 48.966623, 20.023777 48.961071, 20.017863 48.957103, 20.023266 48.955275, 20.019676 48.950087, 20.032757 48.933935, 20.060438 48.932304, 20.035042 48.914298, 19.992261 48.907501, 20.015253 48.901158, 20.158067 48.889202, 20.175661 48.907974, 20.186624 48.900127, 20.246783 48.884804, 20.267459 48.874075, 20.248263 48.870518, 20.241007 48.844495, 20.197184 48.818585, 20.200679 48.806976, 20.19532 48.801464, 20.200378 48.796452, 20.194319 48.790588, 20.20763 48.773564, 20.18195 48.757074, 20.182303 48.728225, 20.190903 48.720113, 20.209728 48.722031, 20.263524 48.692741, 20.290195 48.662214, 20.302389 48.658018, 20.293445 48.644254, 20.303781 48.62349, 20.296459 48.611035, 20.32121 48.604974, 20.333732 48.608683, 20.34249 48.600129, 20.355987 48.598839, 20.347769 48.584091, 20.35052 48.574794, 20.341131 48.56965, 20.331282 48.550623, 20.331713 48.537346, 20.323848 48.53545, 20.318544 48.523895, 20.302672 48.518879, 20.298145 48.504502, 20.30961 48.494983, 20.306424 48.479673, 20.320511 48.474071, 20.341602 48.47278, 20.334462 48.463308, 20.340225 48.461228, 20.369632 48.461268, 20.380033 48.468161, 20.395979 48.456473, 20.413967 48.461149, 20.420277 48.470488, 20.437402 48.467558, 20.455592 48.473565, 20.464326 48.468398, 20.4698187 48.4525456, 20.4515809 48.4484529, 20.4345151 48.4301707, 20.4163443 48.4185193, 20.4146841 48.4100191, 20.4205802 48.4041449, 20.4126464 48.3878099, 20.4025293 48.3825668, 20.4114796 48.3710905, 20.4098119 48.3658749, 20.398992 48.356491, 20.3841231 48.3511552, 20.3865239 48.34775, 20.367629 48.332187, 20.374279 48.326989, 20.365658 48.316606, 20.337465 48.301667, 20.332122 48.293044, 20.335755 48.287672, 20.3281 48.288447, 20.325711 48.272794, 20.307711 48.273067, 20.305762 48.269889, 20.310963 48.265591, 20.286858 48.26164, 20.249724 48.279106, 20.234947 48.279933, 20.22798 48.277232, 20.235381 48.2713, 20.228466 48.262779, 20.214605 48.2589, 20.20383 48.261906, 20.206162 48.250979, 20.184933 48.247978, 20.133188 48.253982, 20.132149 48.247338, 20.139631 48.242869, 20.133746 48.233578, 20.134091 48.225182, 20.102 48.209453, 20.09076 48.19701, 20.070037 48.191702, 20.067814 48.188054, 20.078844 48.183739, 20.061339 48.178365, 20.051884 48.167699, 20.044277 48.167282, 20.043029 48.17313, 20.029038 48.177685, 19.991441 48.168399, 19.988706 48.162168, 19.974394 48.166005, 19.963565 48.152021, 19.951557 48.151548, 19.937114 48.137238, 19.937383 48.131118, 19.908308 48.129545, 19.900433 48.124127, 19.897958 48.129471, 19.902104 48.136575, 19.910273 48.139715, 19.914536 48.146863, 19.90591 48.151304, 19.898745 48.166312, 19.8824 48.164141, 19.879156 48.170447, 19.860131 48.169409, 19.8552187 48.1784432, 19.843943 48.16796, 19.845282 48.162742, 19.8273584 48.1636676, 19.829897 48.166942, 19.821331 48.169081, 19.806584 48.162061, 19.806499 48.1541217, 19.7948001 48.1535187, 19.782415 48.165039, 19.805283 48.183733, 19.798733 48.19482, 19.787163 48.19253, 19.781322 48.201011, 19.766747 48.205685, 19.760709 48.213792, 19.74618 48.216512, 19.734887 48.215166, 19.721125 48.201473, 19.691219 48.203894, 19.674662 48.219739, 19.669857 48.239212, 19.644524 48.239172, 19.6308264 48.2500725, 19.608217 48.238987, 19.577502 48.216015, 19.526044 48.20313, 19.528967 48.190358, 19.504518 48.173443, 19.50977 48.168859, 19.512822 48.154663, 19.508151 48.147585, 19.492377 48.139664, 19.496508 48.135196, 19.494052 48.127125, 19.497077 48.124773, 19.491965 48.117918, 19.49471 48.114709, 19.49092 48.112423, 19.49442 48.109906, 19.484642 48.105193, 19.487216 48.099541, 19.468313 48.092037, 19.467825 48.084072, 19.461304 48.083198, 19.451796 48.09173, 19.451642 48.096672, 19.456994 48.097823, 19.454292 48.101372, 19.442644 48.101269, 19.435307 48.09958, 19.425214 48.088782, 19.409117 48.088953, 19.400018 48.082304, 19.386597 48.091914, 19.371646 48.089678, 19.373553 48.087261, 19.369607 48.085913, 19.355848 48.090761, 19.300955 48.088285, 19.283857 48.082076, 19.276736 48.073948, 19.255282 48.071267, 19.241368 48.053653, 19.212823 48.064362, 19.181172 48.06127, 19.150229 48.06696, 19.135289 48.074146, 19.107402 48.065596, 19.084362 48.072781, 19.058525 48.057353, 19.046236 48.066486, 19.033308 48.064458, 19.024658 48.072628, 19.02051 48.070945, 19.01478 48.075693, 19.018268 48.077668, 19.01391 48.07778, 19.012209 48.088618, 19.013993 48.094102, 19.025917 48.097299, 19.023196 48.102331, 19.030356 48.1092, 19.047658 48.115055, 19.066479 48.134864, 19.06356 48.145419, 19.057999 48.147873, 19.060344 48.150537, 19.049525 48.160594, 19.05914 48.164782, 19.058124 48.177672, 19.070556 48.18418, 19.062315 48.188357, 19.072129 48.194354, 19.050141 48.204629, 19.032454 48.192583, 19.019812 48.189476, 19.016595 48.192287))')
	
	resolution = 3000.m
	
	// add years or set as parameter
	for year in (2020) (
				for urn in observables_urns(	
				context(wkt_context,resolution,Time(year=year),urn
				): state -> (
					set urn_name ""
					if [urn.toString().startsWith("[")] (
						set urn_name [urn.name]
					)
					else (
						set urn_name urn
					)	
					if [state.toString().contains("[nothing")] (
						warning(["Observation " + urn_name + " return nothing"])
					) else (
						state.export(["London Group Paper 2024" + "/" + "SEEA_european_forest_accounts" + "/" + year + "/" + "maps" + "/" + urn_name + ".tiff"]
					)
					
				)
//					,
//				for table_urn in table_urns(
//					context(wkt_context,resolution,Time(year=year),table_urn)
//					pack(:tables): url -> 
//				save(url, filename=["London Group Paper 2024" + "/" + "SEEA_european_forest_accounts" + "/" + year + "/" + "tables" + "/" + table_urn + ".xlsx"])
//				)
			)
		)
	)

